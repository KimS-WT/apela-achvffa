@page "{id:int}"
@model ChoctawGivingCircle.Pages.Admin.Requests.DetailsModel
@{
    ViewData["Title"] = "Request Details";
}

<div class="container py-4">
    <a asp-page="/Admin/Requests/Index" class="btn btn-link px-0 mb-3">← Back to Requests</a>

    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <h1 class="h4">@Model.RequestItem?.Title</h1>
            <p class="text-muted">@Model.RequestItem?.Description</p>

            <dl class="row">
                <dt class="col-sm-3">Category</dt>
                <dd class="col-sm-9">@Model.RequestItem?.Category</dd>

                <dt class="col-sm-3">Priority</dt>
                <dd class="col-sm-9">@Model.RequestItem?.Priority</dd>

                <dt class="col-sm-3">Status</dt>
                <dd class="col-sm-9">@Model.RequestItem?.Status</dd>

                <dt class="col-sm-3">Estimated Cost</dt>
                <dd class="col-sm-9">@Model.RequestItem?.EstimatedCost.ToString("C")</dd>

                <dt class="col-sm-3">Needed By</dt>
                <dd class="col-sm-9">@Model.RequestItem?.NeededByDate?.ToString("D") ?? "Flexible"</dd>

                <dt class="col-sm-3">Requester UserId</dt>
                <dd class="col-sm-9">@Model.RequestItem?.UserId</dd>
            </dl>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-header">
            <strong>Contributions</strong>
        </div>
        <div class="card-body">
            @if (Model.Contributions.Count == 0)
            {
                <p class="text-muted mb-0">No contributions allocated yet.</p>
            }
            else
            {
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Amount</th>
                            <th>Type</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var contribution in Model.Contributions)
                        {
                            <tr>
                                <td>@contribution.CreatedAt.ToLocalTime().ToString("g")</td>
                                <td>@contribution.Amount.ToString("C")</td>
                                <td>@contribution.ContributionType</td>
                                <td>@(string.IsNullOrWhiteSpace(contribution.Notes) ? "—" : contribution.Notes)</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </div>
    </div>
</div>
